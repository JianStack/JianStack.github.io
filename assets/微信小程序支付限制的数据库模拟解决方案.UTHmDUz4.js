import{_ as g}from"./ValaxyMain.vue_vue_type_style_index_0_lang.Dl6f09j6.js";import{e as y,a as c,u}from"./chunks/vue-router.OX6wyTgk.js";import{N as F,a3 as a,U as t,S as i,W as s,u as m,O as f,E as D}from"./framework.CGpsDzRo.js";import"./app.JH9xSBGv.js";import"./chunks/dayjs.CCYrSalk.js";import"./chunks/@vueuse/motion.Cj-llAHY.js";import"./chunks/vue-i18n.BIKvsUT3.js";import"./chunks/pinia.DIgot8h-.js";import"./chunks/nprogress.BahbDzmd.js";import"./YunComment.vue_vue_type_style_index_0_lang.GypxAZnc.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.DnrUgoOv.js";import"./post.CQKmAQPh.js";const C=y("/posts/微信小程序支付限制的数据库模拟解决方案",async h=>JSON.parse('{"title":"可乐多美食速递项目微信小程序支付问题解决方案","description":"","frontmatter":{"title":"可乐多美食速递项目微信小程序支付问题解决方案","date":"2025-06-29","updated":"2025-06-29","categories":"技术分享","tags":["微信小程序","支付","数据库","开发技巧"],"top":1},"headers":[],"relativePath":"pages/posts/微信小程序支付限制的数据库模拟解决方案.md","lastUpdated":1755313729000}'),{lazy:(h,n)=>h.name===n.name}),M={__name:"微信小程序支付限制的数据库模拟解决方案",setup(h,{expose:n}){var E;const{data:k}=C(),d=u(),r=c(),e=Object.assign(r.meta.frontmatter||{},((E=k.value)==null?void 0:E.frontmatter)||{});return r.meta.frontmatter=e,d.currentRoute.value.data=k.value,D("valaxy:frontmatter",e),globalThis.$frontmatter=e,n({frontmatter:{title:"可乐多美食速递项目微信小程序支付问题解决方案",date:"2025-06-29",updated:"2025-06-29",categories:"技术分享",tags:["微信小程序","支付","数据库","开发技巧"],top:1}}),(l,p)=>{const o=g;return f(),F(o,{frontmatter:m(e)},{"main-content-md":a(()=>p[0]||(p[0]=[i("h3",{id:"可乐多美食速递项目微信小程序支付问题解决方案-基于数据库模拟支付流程",tabindex:"-1"},[s("可乐多美食速递项目微信小程序支付问题解决方案：基于数据库模拟支付流程 "),i("a",{class:"header-anchor",href:"#可乐多美食速递项目微信小程序支付问题解决方案-基于数据库模拟支付流程","aria-label":'Permalink to "可乐多美食速递项目微信小程序支付问题解决方案：基于数据库模拟支付流程"'},"​")],-1),i("h4",{id:"一、问题背景与场景说明",tabindex:"-1"},[s("一、问题背景与场景说明 "),i("a",{class:"header-anchor",href:"#一、问题背景与场景说明","aria-label":'Permalink to "一、问题背景与场景说明"'},"​")],-1),i("p",null,[s("在可乐多美食速递项目的开发过程中，遇到了一个典型的开发困境："),i("strong",null,"使用个人主体注册的微信小程序无法开通微信支付功能"),s("。这一限制源于微信官方政策 —— 个人开发者账号不支持商业支付接口，而企业或个体工商户主体才能申请支付权限。")],-1),i("p",null,[s('对于正在开发的 "可乐多外卖速递" 项目而言，若因支付功能阻塞导致项目停滞，将影响整体开发进度。为此，本文提供一种'),i("strong",null,"基于数据库模拟支付流程"),s("的解决方案，无需实际调用微信支付接口，即可完成订单状态的闭环管理。")],-1),i("h4",{id:"二、问题核心-个人主体小程序的支付限制",tabindex:"-1"},[s("二、问题核心：个人主体小程序的支付限制 "),i("a",{class:"header-anchor",href:"#二、问题核心-个人主体小程序的支付限制","aria-label":'Permalink to "二、问题核心：个人主体小程序的支付限制"'},"​")],-1),i("p",null,"微信小程序支付功能的开通条件：",-1),i("ul",null,[i("li",null,[i("strong",null,"企业 / 个体工商户主体"),s("：需提供营业执照、银行账户等资质，可申请微信支付商户号并接入支付接口。")]),i("li",null,[i("strong",null,"个人主体"),s("：仅支持基础功能，无法申请支付权限，直接调用"),i("code",null,"wx.requestPayment"),s("会报错。")])],-1),i("p",null,"此限制导致开发中面临的具体问题：",-1),i("ul",null,[i("li",null,'前端调用支付接口时提示 "权限不足" 或无响应'),i("li",null,"后端无法接收支付回调，订单状态无法更新"),i("li",null,"项目流程无法闭环，影响测试与演示效果")],-1),i("h4",{id:"三、解决方案-数据库模拟支付流程",tabindex:"-1"},[s("三、解决方案：数据库模拟支付流程 "),i("a",{class:"header-anchor",href:"#三、解决方案-数据库模拟支付流程","aria-label":'Permalink to "三、解决方案：数据库模拟支付流程"'},"​")],-1),i("h5",{id:"一-核心思路",tabindex:"-1"},[s("（一）核心思路 "),i("a",{class:"header-anchor",href:"#一-核心思路","aria-label":'Permalink to "（一）核心思路"'},"​")],-1),i("p",null,[s("绕过微信支付接口，通过"),i("strong",null,"直接修改数据库订单状态"),s("来模拟支付成功流程。具体逻辑如下：")],-1),i("ol",null,[i("li",null,'前端点击 "支付" 按钮后，跳过真实支付接口调用'),i("li",null,"后端接收支付请求后，直接更新订单状态（已支付、待接单等）"),i("li",null,"前端跳转至支付成功页面，完成用户交互闭环")],-1),i("h5",{id:"二-后端实现-修改订单控制器",tabindex:"-1"},[s("（二）后端实现：修改订单控制器 "),i("a",{class:"header-anchor",href:"#二-后端实现-修改订单控制器","aria-label":'Permalink to "（二）后端实现：修改订单控制器"'},"​")],-1),i("p",null,[s("在"),i("code",null,"OrderController.java"),s("中重构支付接口，注释原有的微信支付逻辑，改为直接调用订单状态更新方法：")],-1),i("div",{class:"language-java vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PutMapping"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/payment"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"订单支付"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Result"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," payment"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," OrdersPaymentDTO ordersPaymentDTO) throws Exception {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    log."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"info"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"订单支付：{}"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ordersPaymentDTO);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 调用服务层方法直接修改数据库状态")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    orderService."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"paySuccess"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ordersPaymentDTO."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getOrderNumber"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()); ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Result."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"success"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"collapse"})],-1),i("p",null,[i("code",null,"paySuccess"),s("方法的核心逻辑（示例）：")],-1),i("div",{class:"language-java vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// OrderService.java")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," paySuccess"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String orderNumber) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1. 根据订单号查询订单")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Orders orders "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ordersMapper."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"findByOrderNumber"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(orderNumber);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (orders "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," BusinessException"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"订单不存在"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},'    // 2. 修改订单状态为"待接单"（状态码示例：10待支付，20待接单）')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    orders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setStatus"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},'    // 3. 设置支付状态为"已支付"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    orders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setPaymentStatus"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4. 记录支付时间")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    orders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setPayTime"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(LocalDateTime."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"now"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 5. 更新数据库")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ordersMapper."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"update"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(orders);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"collapse"})],-1),i("h5",{id:"三-前端实现-跳过支付接口调用",tabindex:"-1"},[s("（三）前端实现：跳过支付接口调用 "),i("a",{class:"header-anchor",href:"#三-前端实现-跳过支付接口调用","aria-label":'Permalink to "（三）前端实现：跳过支付接口调用"'},"​")],-1),i("p",null,[s("在小程序前端"),i("code",null,"pages/pay/index.js"),s("中修改支付逻辑：")],-1),i("ol",null,[i("li",null,[s("注释掉"),i("code",null,"wx.requestPayment"),s("接口调用")]),i("li",null,"直接添加页面重定向代码，模拟支付成功跳转")],-1),i("div",{class:"language-javascript vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"javascript"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 原支付逻辑（修改前）")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (res.code "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"==="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  wx."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"requestPayment"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    nonceStr: res.data.nonceStr,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    package: res.data.packageStr,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    paySign: res.data.paySign,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    timeStamp: res.data.timeStamp,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    signType: res.data.signType,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    success"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"function"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"res"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      wx."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"showModal"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        title: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'提示'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        content: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'支付成功'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        success"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"function"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          uni."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"redirectTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({url: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'/pages/success/index?orderId='"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," _this.orderId });")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      })")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      console."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'支付成功!'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  })")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 修改后逻辑（跳过支付接口，直接跳转）")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (res.code "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"==="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  // 注释掉wx.requestPayment整个方法")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  // 直接重定向到支付成功页面")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  uni."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"redirectTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({url: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'/pages/success/index?orderId='"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," _this.orderId });")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"} "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  wx."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"showModal"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    title: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'提示'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    content: res.msg")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  })")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"collapse"})],-1),i("h4",{id:"四、方案效果与注意事项",tabindex:"-1"},[s("四、方案效果与注意事项 "),i("a",{class:"header-anchor",href:"#四、方案效果与注意事项","aria-label":'Permalink to "四、方案效果与注意事项"'},"​")],-1),i("h5",{id:"一-实现效果",tabindex:"-1"},[s("（一）实现效果 "),i("a",{class:"header-anchor",href:"#一-实现效果","aria-label":'Permalink to "（一）实现效果"'},"​")],-1),i("ul",null,[i("li",null,'前端交互：点击 "支付" 后直接跳转成功页，用户体验与真实支付一致'),i("li",null,"后端数据：订单状态、支付状态、时间等字段正常更新，满足业务流程需求"),i("li",null,"项目进度：无需等待资质申请，可继续完成订单管理、配送等后续功能开发")],-1),i("h5",{id:"二-适用场景",tabindex:"-1"},[s("（二）适用场景 "),i("a",{class:"header-anchor",href:"#二-适用场景","aria-label":'Permalink to "（二）适用场景"'},"​")],-1),i("ul",null,[i("li",null,"开发测试阶段：用于本地调试、功能演示、项目验收"),i("li",null,"个人开发者 Demo：无需实际支付的小型项目或学习案例")],-1),i("h5",{id:"三-生产环境提示",tabindex:"-1"},[s("（三）生产环境提示 "),i("a",{class:"header-anchor",href:"#三-生产环境提示","aria-label":'Permalink to "（三）生产环境提示"'},"​")],-1),i("p",null,[s("此方案为"),i("strong",null,"开发测试临时方案"),s("，正式上线需注意：")],-1),i("ol",null,[i("li",null,[s("企业主体需按微信官方流程申请支付权限（"),i("a",{href:"https://pay.weixin.qq.com/%EF%BC%89",target:"_blank",rel:"noreferrer"},"https://pay.weixin.qq.com/）")]),i("li",null,"真实支付需处理支付回调、异常重试、资金对账等安全逻辑"),i("li",null,"数据库直接修改状态存在安全风险，生产环境严禁使用此方式")],-1),i("h4",{id:"五、总结",tabindex:"-1"},[s("五、总结 "),i("a",{class:"header-anchor",href:"#五、总结","aria-label":'Permalink to "五、总结"'},"​")],-1),i("p",null,"在微信小程序开发中，个人主体的支付限制是常见问题。通过数据库模拟支付流程，我们可以在不依赖真实支付接口的情况下完成项目开发，确保流程闭环。这种方案适用于开发测试场景，既解决了项目阻塞问题，又为后续正式环境的支付接入预留了扩展空间。",-1)])),"main-header":a(()=>[t(l.$slots,"main-header")]),"main-header-after":a(()=>[t(l.$slots,"main-header-after")]),"main-nav":a(()=>[t(l.$slots,"main-nav")]),"main-content-before":a(()=>[t(l.$slots,"main-content-before")]),"main-content":a(()=>[t(l.$slots,"main-content")]),"main-content-after":a(()=>[t(l.$slots,"main-content-after")]),"main-nav-before":a(()=>[t(l.$slots,"main-nav-before")]),"main-nav-after":a(()=>[t(l.$slots,"main-nav-after")]),comment:a(()=>[t(l.$slots,"comment")]),footer:a(()=>[t(l.$slots,"footer")]),aside:a(()=>[t(l.$slots,"aside")]),"aside-custom":a(()=>[t(l.$slots,"aside-custom")]),default:a(()=>[t(l.$slots,"default")]),_:3},8,["frontmatter"])}}};export{M as default,C as usePageData};
